<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="A Strand" />

<meta name="date" content="2018-01-03" />

<title>Thinning single stages rather than randomly</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Thinning single stages rather than randomly</h1>
<h4 class="author"><em>A Strand</em></h4>
<h4 class="date"><em>2018-01-03</em></h4>



<p>When a population in rmetasim reaches carrying capacity, individuals are killed at random. That is, the probability of an individual dying during this thinning process is (N-K)/N where N is the size of a population and K is carrying capacity for that population.</p>
<p>There may be situations where one might want to apply the carrying capacity thinning with more delicacy. This vignette provides one such approach.</p>
<p>The idea is to break apart the components of a discrete time simulation implemented in the function ‘landscape.simulate()’ Rmetasim provides a full set of these components (see the vignette on setting up simulations).</p>
<p>In each time-click, landscape.simulate(): 1. applies the extinction vector to the landscape 2. lets individuals reproduce 3. applies growth and survival 4. carrying capacity thinning is implemented 5. counters are advanced.</p>
<p>Each of these steps have been implemented in rmetasim functions (respectively): 1. landscape.extinct() 2. landscape.reproduce() 3. landscape.survive() 4. landscape.carry() 5. landscape.advance()</p>
<p>landscape.carry() can be replaced with a different approach to carrying capacity thinning..</p>
<div id="setup-landscape" class="section level3">
<h3>Setup landscape</h3>
<p>This will be a 2 habitat with 2 stages per habitat landscape</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rmetasim)
l &lt;-<span class="st"> </span><span class="kw">landscape.new.example</span>()</code></pre></div>
</div>
<div id="landscape.stagecarry" class="section level3">
<h3>landscape.stagecarry()</h3>
<p>This function will take a landscape and a matrix of stage proportions. If a population is above its carrying capacity, individuals will be removed based on these stage proportions. This matrix will have the number of rows equal to the number of habitats and the number of columns equal to the stages in a habitat.</p>
<p>Each cell in a matrix row will equal the proportion of individuals in that stage that should be thinned. In the following, the matrix is called <em>SK</em>. Each row should sum to 1. If they do not, they will be normalized before thinning.</p>
<pre><code>##       stage 1 stage 2
## pop 1     0.8     0.2
## pop 2     0.5     0.5</code></pre>
<p>This matrix specifies that in pop1 80% of the individuals thinned for carrying capacity come from stage 1. Inb pop2 the individuals come from each of the stages equally. If there are not enough individuals in a stage to meet the carrying capacity limit by thinning, additional thinning will be applied at random to all stages in the population.</p>
<p>This function implements the stage carrying</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">landscape.stagecarry &lt;-<span class="st"> </span><span class="cf">function</span>(l,sk)
{
    k=l<span class="op">$</span>demography<span class="op">$</span>epochs[[<span class="dv">1</span>]]<span class="op">$</span>Carry <span class="co"># carrying capacities</span>
    n=<span class="kw">c</span>(<span class="kw">table</span>(<span class="kw">landscape.populations</span>(l))) <span class="co">#pop sizes</span>
    
    <span class="co">#next several lines are supposed to padd out extirpated populations in the popsize vector</span>
    n2=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(k))
    <span class="kw">names</span>(n2)=<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">names</span>(n)) {pos=<span class="kw">which</span>(<span class="kw">names</span>(n2)<span class="op">==</span>i); n2[pos]=n[<span class="kw">names</span>(n)<span class="op">==</span>i]}
    n=n2
    killrows &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k),<span class="cf">function</span>(i) <span class="co">#never that many populations, this is probably plenty fast</span>
        {
          <span class="cf">if</span> (n[i]<span class="op">&gt;</span>k[i]) <span class="co">#population i has a pop size greater than carrying capacity  </span>
           {
            poprows =<span class="st"> </span><span class="kw">which</span>(<span class="kw">landscape.populations</span>(l)<span class="op">%in%</span>i)
            abstages =<span class="st"> </span>(i<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">dim</span>(sk)[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span>(<span class="kw">dim</span>(sk)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)
            absrows =<span class="st"> </span><span class="kw">lapply</span>(abstages,<span class="cf">function</span>(stg)
                {<span class="kw">which</span>(l<span class="op">$</span>individuals[,<span class="dv">1</span>]<span class="op">==</span>stg)})
            inds.to.thin =<span class="st"> </span><span class="kw">ceiling</span>(sk[i,] <span class="op">*</span><span class="st"> </span>(n[i]<span class="op">-</span>k[i]))
            (<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(sk)[<span class="dv">2</span>], <span class="cf">function</span>(stg) { <span class="cf">if</span> (<span class="kw">length</span>(absrows[[stg]])<span class="op">&gt;</span><span class="dv">0</span>) <span class="kw">sample</span>(absrows[[stg]],inds.to.thin[stg],<span class="dt">replace=</span>F) }))
            }
      }))

    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(killrows)) l<span class="op">$</span>individuals&lt;-l<span class="op">$</span>individuals[(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>killrows,]
    l
}</code></pre></div>
</div>
<div id="running-the-simulation" class="section level3">
<h3>Running the simulation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rland &lt;-<span class="st"> </span><span class="kw">landscape.new.example</span>()
rland<span class="op">$</span>demography<span class="op">$</span>localdem[[<span class="dv">1</span>]]<span class="op">$</span>LocalS &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="fl">0.05</span>),<span class="dt">nrow=</span><span class="dv">2</span>) <span class="co">#make sure that there is some complexity</span>
gens=<span class="dv">400</span>
stagesize=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">nrow=</span>gens)
<span class="cf">for</span> (gen <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>gens)
    {

        rland &lt;-<span class="st"> </span><span class="kw">landscape.extinct</span>(rland)
        rland &lt;-<span class="st"> </span><span class="kw">landscape.reproduce</span>(rland)
        rland &lt;-<span class="st"> </span><span class="kw">landscape.survive</span>(rland)
        rland &lt;-<span class="st"> </span><span class="kw">landscape.stagecarry</span>(rland,SK)
        stagesize[gen,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(rland<span class="op">$</span>individuals[,<span class="dv">1</span>]))

        rland &lt;-<span class="st"> </span><span class="kw">landscape.carry</span>(rland)   <span class="co">#if N is still &gt; K which happens if there are few inds in a stage that you want to thin</span>
                                          <span class="co"># apply the normal carry function (thins the remaining stages using the normal approach)</span>
        rland &lt;-<span class="st"> </span><span class="kw">landscape.advance</span>(rland)
    }</code></pre></div>
<p>These plots show the relative sizes of the different stages in the simulation. black and red are the stages in the first population and green and blue, population 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(stagesize,<span class="dt">type=</span><span class="st">'l'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(stagesize[<span class="dv">100</span><span class="op">:</span>gens,],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>) <span class="co">#clip the first 100 time clicks.  resets the index to zero for gen 100</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
